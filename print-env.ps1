$ErrorActionPreference = 'Stop'

# remove C:\Program Files\dotnet\ from path to show the bug
$env:Path = ${env:Path}.Replace("C:\Program Files\dotnet","")

"Env:"
"-------------------------------------------------------------------------"
Get-ChildItem env:\
"-------------------------------------------------------------------------"
"-------------------------------------------------------------------------"

"PATH:" 
"-------------------------------------------------------------------------"
${env:Path}.Split(';')
"-------------------------------------------------------------------------"
"-------------------------------------------------------------------------"

"DOTNET_ROOT: ${env:DOTNET_ROOT}"
"-------------------------------------------------------------------------"
"-------------------------------------------------------------------------"

"dotnet:" 
"-------------------------------------------------------------------------"
Get-Command dotnet
"-------------------------------------------------------------------------"
"-------------------------------------------------------------------------"

"msbuild:" 
"-------------------------------------------------------------------------"
Get-Command msbuild
"-------------------------------------------------------------------------"
"-------------------------------------------------------------------------"
