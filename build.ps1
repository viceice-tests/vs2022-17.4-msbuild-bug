$ErrorActionPreference = 'Stop'

# remove C:\Program Files\dotnet\ from path to show the bug
$env:Path = ${env:Path}.Replace("C:\Program Files\dotnet","")

"PATH:" 
${env:Path}.Split(';')

"-------------------------------------------------------------------------"
"-------------------------------------------------------------------------"

"Restore:"
dotnet restore Sample
"-------------------------------------------------------------------------"
if($LASTEXITCODE){
    throw "restore error"
}
"-------------------------------------------------------------------------"
"-------------------------------------------------------------------------"

"dotnet build:"
"-------------------------------------------------------------------------"
dotnet build Sample
if($LASTEXITCODE){
    throw "dotnet build error"
}
"-------------------------------------------------------------------------"
"-------------------------------------------------------------------------"

"msbuild build:"
"-------------------------------------------------------------------------"
msbuild Sample
if($LASTEXITCODE){
    throw "msbuild error"
}